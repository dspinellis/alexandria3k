
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Development processes &#8212; alexandria3k 3.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plugin development" href="dev-plugin.html" />
    <link rel="prev" title="Performance monitoring" href="perf.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="development-processes">
<h1>Development processes<a class="headerlink" href="#development-processes" title="Permalink to this headline">¶</a></h1>
<p>For software development purposes <em>alexandria3k</em> can also be installed
and used through its <a class="reference external" href="https://github.com/dspinellis/alexandria3k">Github
repository</a>, rather than
as a Python package.</p>
<div class="section" id="installation">
<span id="installation-1"></span><h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/dspinellis/alexandria3k.git
<span class="nb">cd</span> alexandra3k/src
pipenv install
</pre></div>
</div>
</div>
<div class="section" id="development-environment">
<h2>Development environment<a class="headerlink" href="#development-environment" title="Permalink to this headline">¶</a></h2>
<p>Perform the following steps for setting up a virtual environment
with the required development dependencies.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in alexandria3k/src directory</span>

<span class="c1"># Install development dependencies</span>
pipenv install --dev

<span class="c1"># Launch a shell in the virtual environment</span>
pipenv shell
</pre></div>
</div>
<p>You can then run the command-line version from the source distribution on the
top-level directory as follows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>bin/a3k --help
</pre></div>
</div>
</div>
<div class="section" id="continuous-integration">
<h2>Continuous integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h2>
<p>GitHub actions are used for running unit tests, linting, verifying the
code’s format, as well as building the package and the documentation
when a new commit is pushed to GitHub.
Before doing so, it’s advisable to perform these actions locally,
as detailed in the following sections.
In addition, testing, formatting, and linting can be easilly configured
to be run as a fast Git pre-commit hook by running the following commands
at the top-level directory.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">printf</span> <span class="s1">&#39;#!/bin/sh\nbin/pre-commit\n&#39;</span> &gt;.git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
</pre></div>
</div>
</div>
<div class="section" id="debugging-and-logging">
<h2>Debugging and logging<a class="headerlink" href="#debugging-and-logging" title="Permalink to this headline">¶</a></h2>
<p>Much of the <em>alexandria3k</em> code is executed by means of callbacks
through the <em>SQLite</em> <em>apsw</em> module.
This makes it difficult to trace and debug.
The liberal use of <code class="docutils literal notranslate"><span class="pre">print</span></code> statements is your friend.
In addition, <em>alexandria3k</em> offers many debug options,
which you should be using for troubleshooting.
Run <code class="docutils literal notranslate"><span class="pre">a3k</span> <span class="pre">--help</span></code> to see which options are available.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="python-unit-and-integration-tests">
<h3>Python unit and integration tests<a class="headerlink" href="#python-unit-and-integration-tests" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
python3 -m unittest discover -s .
</pre></div>
</div>
</div>
<div class="section" id="sql-unit-tests">
<h3>SQL unit tests<a class="headerlink" href="#sql-unit-tests" title="Permalink to this headline">¶</a></h3>
<p>To run SQL unit tests install
<a class="reference external" href="https://github.com/dspinellis/rdbunit">rdbunit</a> and the
<a class="reference external" href="https://www.sqlite.org/index.html">SQLite</a> command-line tool.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
<span class="k">for</span> t in tests/*.rdbu<span class="p">;</span> <span class="k">do</span> rdbunit --database<span class="o">=</span>sqlite <span class="nv">$t</span> <span class="p">|</span> sqlite3 <span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="code-formatting">
<h2>Code formatting<a class="headerlink" href="#code-formatting" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
find src -name <span class="s1">&#39;*.py&#39;</span> <span class="p">|</span> xargs black -l <span class="m">79</span>
</pre></div>
</div>
</div>
<div class="section" id="linting">
<h2>Linting<a class="headerlink" href="#linting" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
find src -name <span class="s1">&#39;*.py&#39;</span> <span class="p">|</span> xargs python -m pylint --rcfile .pylintrc
</pre></div>
</div>
</div>
<div class="section" id="plugin-documentation">
<h2>Plugin documentation<a class="headerlink" href="#plugin-documentation" title="Permalink to this headline">¶</a></h2>
<p>When data source or processing plugins are added the Python API
documentation must be updated as follows.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
bin/update-python-api
</pre></div>
</div>
<p>For users on MacOS, this might require installing the
<a class="reference external" href="https://formulae.brew.sh/formula/gnu-sed">GNU sed</a> package.</p>
</div>
<div class="section" id="application-examples-documentation">
<h2>Application examples documentation<a class="headerlink" href="#application-examples-documentation" title="Permalink to this headline">¶</a></h2>
<p>When new application examples are added in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory
documentation must be updated as follows.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
bin/update-app-eg
</pre></div>
</div>
<p>This requires an installed version of <a class="reference external" href="https://pandoc.org/">Pandoc</a>.</p>
</div>
<div class="section" id="database-schema-diagrams">
<h2>Database schema diagrams<a class="headerlink" href="#database-schema-diagrams" title="Permalink to this headline">¶</a></h2>
<p>After the database schema has changed, its relational diagrams in the
documentation must be updated as follows.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
bin/update-schema
</pre></div>
</div>
<p>This requires an installed version of the <a class="reference external" href="https://graphviz.org/">GraphViz</a>
<em>dot</em> command.</p>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># While in the top-level directory</span>
hatch build dist/
</pre></div>
</div>
<p>This will result in built files being placed in the <code class="docutils literal notranslate"><span class="pre">dist</span></code> directory.</p>
</div>
<div class="section" id="documentation-building">
<h2>Documentation building<a class="headerlink" href="#documentation-building" title="Permalink to this headline">¶</a></h2>
<p>The process for converting the documentation into HTML and a Unix <em>man</em> page
is documented in the
<a class="reference internal" href="installation.html"><span class="doc">installation instructions</span></a>.</p>
</div>
<div class="section" id="adding-a-new-data-source">
<h2>Adding a new data source<a class="headerlink" href="#adding-a-new-data-source" title="Permalink to this headline">¶</a></h2>
<p>Adding a new data source to <em>alexandria3k</em> involves the addition of a
new plugin, as described in <a class="reference internal" href="dev-plugin.html"><span class="doc">Plugin development</span></a>.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">alexandria3k</a></h1>



<p class="blurb">Local relational access to openly-available publication data sets</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=dspinellis&repo=alexandria3k&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading.html">Data downloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="use.html">Use overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli-eg.html">Command line examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-eg.html">Python API examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="app-eg.html">Application examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Schema diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-api.html">Python user API</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin-api.html">Python plugin API</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility-api.html">Python utility API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Development processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#development-environment">Development environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-integration">Continuous integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-and-logging">Debugging and logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-formatting">Code formatting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linting">Linting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plugin-documentation">Plugin documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-examples-documentation">Application examples documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-schema-diagrams">Database schema diagrams</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="#documentation-building">Documentation building</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-new-data-source">Adding a new data source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dev-plugin.html">Plugin development</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ: Frequently asked questions</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="None">Version: 3.2.0</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="perf.html" title="previous chapter">Performance monitoring</a></li>
      <li>Next: <a href="dev-plugin.html" title="next chapter">Plugin development</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022-2024, Diomidis Spinellis.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/dev.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>